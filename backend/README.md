# Council of AI - Backend (TC260 Security Enhanced)

AI Safety Verification Platform API powered by 32 specialized AI councils.

**Security Level:** TC260 Compliant  
**Version:** 2.0.0

---

## Quick Start

### 1. Create Virtual Environment

```bash
python3.11 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

### 2. Install Dependencies

```bash
pip install -r requirements.txt
```

### 3. Configure Environment

Copy `.env.example` to `.env` and update with your credentials:

```bash
cp .env.example .env
nano .env  # Edit with your values
```

**Important:** The `.env` file contains sensitive secrets. Never commit it to Git.

### 4. Initialize Database

```bash
# Initialize Alembic
alembic init alembic

# Create initial migration
alembic revision --autogenerate -m "Initial schema"

# Run migration
alembic upgrade head
```

### 5. Run Development Server

```bash
uvicorn main:app --reload --port 8000
```

The API will be available at:
- API: http://localhost:8000
- Docs: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

---

## Security Features (TC260 Compliant)

This backend implements comprehensive security measures based on China's TC260 AI Safety Framework:

### 1. Data Encryption
- **TLS 1.2+** enforced for all connections
- **Encryption at rest** enabled in PostgreSQL
- **Secure environment variables** with restricted permissions

### 2. Authentication & Authorization
- **JWT tokens** with short-lived access tokens (15min) and refresh tokens (7 days)
- **Role-Based Access Control (RBAC)** for fine-grained permissions
- **Secure password hashing** using bcrypt
- **API key management** with SHA-256 hashing

### 3. Input Validation & Sanitization
- **Pydantic models** for automatic type validation
- **Input sanitization** to prevent injection attacks

### 4. Rate Limiting
- **Redis-based rate limiting** to protect against brute-force and DoS attacks
- Configurable limits (default: 100 requests/minute per IP)

### 5. Audit Logging
- **Structured JSON logging** for all API requests and responses
- **Comprehensive audit trail** of all verification activities
- **Immutable blockchain logging** via ProofOf.AI integration

### 6. PII Protection
- **PII fields tagged** in database models
- **Data retention policies** for GDPR/CCPA compliance
- **User rights API** for data access and deletion requests

---

## Project Structure

```
backend/
├── api/              # API routes and endpoints
├── councils/         # AI council implementations
├── models/           # Database models (with PII tagging)
├── services/         # Business logic services
├── middleware/       # Security middleware (rate limiting, audit logging)
├── utils/            # Utility functions (security, hashing, etc.)
├── tests/            # Test suite
├── alembic/          # Database migrations
├── config.py         # Configuration management
├── database.py       # Database connection
├── main.py           # FastAPI application
└── requirements.txt  # Python dependencies
```

---

## Security Checklist

See `SECURITY_CHECKLIST.md` for the complete TC260 compliance checklist.

---

## Development

### Run Tests

```bash
pytest
```

### Run Security Scan

```bash
# Scan for security vulnerabilities
bandit -r .

# Check dependencies for known vulnerabilities
safety check
```

### Code Formatting

```bash
black .
isort .
```

---

## Deployment

### Railway

```bash
# Login to Railway
railway login

# Link to project
railway link {project_id}

# Deploy
railway up
```

### Environment Variables (Production)

Set these in Railway dashboard:

- `DATABASE_URL` - PostgreSQL connection string
- `REDIS_URL` - Redis connection string
- `SECRET_KEY` - Application secret key
- `JWT_SECRET_KEY` - JWT signing key
- `ENVIRONMENT` - Set to "production"
- `ENABLE_RATE_LIMITING` - Set to "true"
- `ENABLE_AUDIT_LOGGING` - Set to "true"
- `ENABLE_BLOCKCHAIN_LOGGING` - Set to "true"

---

## License

MIT License - see LICENSE file for details.

---

**Generated by:** Council of AI Secure Setup Automation Script  
**Date:** December 14, 2025  
**Security Level:** TC260 Compliant  
**SECRET_KEY:** myXJzqeZrNFK9dEbyX4hN0AGBruKxYyIH2OpJXHqyrY  
**JWT_SECRET_KEY:** klKJ_O35vOPxvdAlYb7Imr8ufKqTXKa-XejW3CJ8Q5M
